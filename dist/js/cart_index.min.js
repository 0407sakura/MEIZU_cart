"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function convertStrToObj(t){return t?JSON.parse(t):{}}function shopNum(){$(".count span:nth-child(1)").text($(".one").length),$(".count span:nth-child(2)").text($(".one:checked").length)}function shopTotal(){var countTotal=0;$($(".one:checked")).each(function(){countTotal+=eval($(this).parent().parent().children(".total").text())}),$(".totalprice").text(countTotal)}var Cart=function(){function t(){_classCallCheck(this,t),this.mycenter(),this.event(),this.other(),this.paymoney(),this.delCheck()}return _createClass(t,[{key:"event",value:function(){var n=convertStrToObj($.cookie("products")?$.cookie("products"):"");jQuery.each(n,function(t){var e=n[t];$(".m-c-footer").prev().append('<ul class="goodInfo" data-good-id="'.concat(t,'">\n                <li><input type="checkbox" class="one opt"></li>\n                <li><img src="').concat(e.src,'"></li>\n\t\t\t\t<li><p>').concat(e.name,"</p><p>").concat(e.tips,"</p></li>\n\t\t\t\t<li>").concat(e.price,'</li>\n\t\t\t\t<li class="num">\n\t\t\t\t\t<a href="javascript:;" class="minus">-</a>\n\t\t\t\t\t<input type="text" name="" id="" value="').concat(e.num,'" />\n\t\t\t\t\t<a href="javascript:;" class="plus">+</a>\n\t\t\t\t</li>\n\t\t\t\t<li class="total">').concat(e.price*e.num,'</li>\n\t\t\t\t<li><a href="javascript:;" class="delete">--</a></li>\n            </ul>'))}),$(".minus").each(function(){$(this).click(function(){var t=$(this).parent().parent().attr("data-good-id"),e=convertStrToObj($.cookie("products")?$.cookie("products"):"");1<e[t].num&&e[t].num--,$.cookie("products",JSON.stringify(e)),$(this).next().val(e[t].num),$(this).parent().next().text(e[t].price*e[t].num),shopTotal()})}),$(".plus").click(function(){var t=$(this).parent().parent().attr("data-good-id"),e=convertStrToObj($.cookie("products")?$.cookie("products"):"");e[t].num++,$.cookie("products",JSON.stringify(e)),$(this).prev().val(e[t].num),$(this).parent().next().text(e[t].price*e[t].num),shopTotal()}),$(".num>input").blur(function(){var t=$(this).parent().parent().attr("data-good-id"),e=convertStrToObj($.cookie("products")?$.cookie("products"):""),n=$(this).val();/^\d+$/.test(n)&&0<n||(n=1),e[t].num=n,$.cookie("products",JSON.stringify(e)),$(this).val(e[t].num),$(this).parent().next().text=e[t].price*e[t].num}),$(".editor").click(function(){$(this).toggleClass("finnished"),$(this).hasClass("finnished")?($(this).text("完成"),$(".delete").html('<span class="iconfont icon-cuo"></span>'),$(".icon-cuo").click(function(){var t=$(this).parent().parent().parent(),e=($(".mz-mask").css("display","block"),$(".icon-guanbijiantou").click(function(){$(".mz-mask").css("display","none")}),$(".success").click(function(){$(".mz-mask").css("display","none")}),$(".cancel").click(function(){$(".mz-mask").css("display","none"),t.remove(),shopNum(),shopTotal()}),t.attr("data-good-id")),n=convertStrToObj($.cookie("products")?$.cookie("products"):""),e=(delete n[e],$.cookie("products",JSON.stringify(n)),convertStrToObj($.cookie("products")?$.cookie("products"):""));$.isEmptyObject(e)&&($(".noshop").css("display","block"),$(".m-center").css("display","none"))})):($(this).text("编辑"),$(".delete").html("--"))})}},{key:"other",value:function(){function t(){$(".count span:nth-child(1)").text($(".one").length),$(".count span:nth-child(2)").text($(".one:checked").length)}t(),$(".all").click(function(){$(this).is(":checked")?$(".opt").prop("checked",!0):$(".opt").prop("checked","")}),$(".one").click(function(){$(".one:checked").length===$(".one").length?$(".all").prop("checked",!0):$(".all").prop("checked","")}),$(".opt").click(function(){t(),shopTotal(),0<$(".one:checked").length?($(".free").text("已免运费"),$(".payit").css("background-color","#F66567")):($(".free").text(" "),$(".payit").css("background-color","#DBDBDB"))}),t()}},{key:"mycenter",value:function(){$(".user").hover(function(){$("#personal").attr("class","iconfont icon-jiantoushang")},function(){$("#personal").attr("class","iconfont icon-jiantouxia")})}},{key:"paymoney",value:function(){var t=this,e=0;$.each($(".one"),function(){$(t).is(":checked")&&(e+=$(t).parent().parent().children(".totalprice"))}),$(".totalprice").text(e)}},{key:"delCheck",value:function(){$(".del").click(function(){$(".mz-mask").css("display","block"),$(".icon-guanbijiantou").click(function(){$(".mz-mask").css("display","none")}),$(".success").click(function(){$(".mz-mask").css("display","none")}),$(".cancel").click(function(){$(".mz-mask").css("display","none"),$.each($(".one:checked"),function(){var t=$(this).parents(".goodInfo").attr("data-good-id");$(this).parents(".goodInfo").remove();var e=convertStrToObj($.cookie("products")?$.cookie("products"):""),t=(delete e[t],$.cookie("products",JSON.stringify(e)),convertStrToObj($.cookie("products")?$.cookie("products"):""));$.isEmptyObject(t)&&($(".noshop").css("display","block"),$(".m-center").css("display","none"))})}),shopNum(),shopTotal()})}}]),t}();new Cart;